<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>비밀번호 찾기 - HealnGo</title>
    <link rel="stylesheet" href="/resources/css/styles.css">
    <link rel="stylesheet" href="/resources/css/forgot-password.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div th:replace="common/header :: header"></div>

    <div class="forgot-password-page-wrapper">
        <div class="forgot-password-container">
            <h1>비밀번호 찾기</h1>
            <p>간편하게 비밀번호를 재설정하세요</p>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-steps">
                    <div class="progress-step active" id="progressStep1">
                        <span class="step-number">1</span>
                        <span class="step-text">이메일 인증</span>
                    </div>
                    <div class="progress-step" id="progressStep2">
                        <span class="step-number">2</span>
                        <span class="step-text">비밀번호 재설정</span>
                    </div>
                    <div class="progress-step" id="progressStep3">
                        <span class="step-number">3</span>
                        <span class="step-text">완료</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="alert-box" id="alertBox"></div>

            <!-- Step 1: 이메일 인증 -->
            <div class="step-content active" id="step1">
                <div class="step-header">
                    <h2>이메일 인증</h2>
                    <p>등록하신 이메일 주소를 입력해주세요.</p>
                </div>

                <form class="forgot-form">
                    <div class="form-group">
                        <label for="email">이메일</label>
                        <input type="email" id="email" placeholder="example@email.com" required>
                    </div>

                    <button type="button" class="primary-btn" id="sendCodeBtn" onclick="sendVerificationCode()">
                        <i class="fas fa-paper-plane"></i>
                        인증 코드 전송
                    </button>

                    <div class="form-group">
                        <label for="verificationCode">인증 코드</label>
                        <div class="code-input-group">
                            <input type="text" id="verificationCode" placeholder="인증 코드 입력">
                            <button type="button" class="verify-btn" onclick="verifyEmail()">
                                확인
                            </button>
                        </div>
                        <div id="timer" class="timer-text"></div>
                    </div>
                </form>

                <div class="back-link">
                    <a href="/login">
                        <i class="fas fa-arrow-left"></i>
                        로그인으로 돌아가기
                    </a>
                </div>
            </div>

            <!-- Step 2: 비밀번호 재설정 -->
            <div class="step-content" id="step2">
                <div class="step-header">
                    <h2>새 비밀번호 설정</h2>
                    <p>새로운 비밀번호를 입력해주세요.</p>
                </div>

                <form class="forgot-form">
                    <div class="form-group">
                        <label for="newPassword">새 비밀번호</label>
                        <input type="password" id="newPassword" placeholder="8자 이상 입력" required>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">비밀번호 확인</label>
                        <input type="password" id="confirmPassword" placeholder="비밀번호 재입력" required>
                    </div>

                    <div class="button-group">
                        <button type="button" class="secondary-btn" onclick="previousStep()">
                            <i class="fas fa-arrow-left"></i>
                            이전
                        </button>
                        <button type="button" class="primary-btn" onclick="resetPassword()">
                            <i class="fas fa-check"></i>
                            비밀번호 재설정
                        </button>
                    </div>
                </form>
            </div>

            <!-- Step 3: 완료 -->
            <div class="step-content" id="step3">
                <div class="success-message">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>비밀번호가 재설정되었습니다!</h2>
                    <p>새로운 비밀번호로 로그인해주세요.</p>
                    
                    <button type="button" class="primary-btn" onclick="goToLogin()">
                        <i class="fas fa-sign-in-alt"></i>
                        로그인 페이지로 이동
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="common/footer :: footer"></div>

    <script th:src="@{/crm/js/forgot-password.js}"></script>
</body>
</html>
