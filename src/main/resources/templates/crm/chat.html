<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>채팅 - HealnGo</title>
    <link rel="stylesheet" href="/resources/css/styles.css">
    <link rel="stylesheet" href="/crm/css/chat.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <meta name="_csrf_header" content="${_csrf.headerName}">
    <meta name="_csrf" content="${_csrf.token}">
</head>
<body>
    <!-- 헤더 -->
    <div th:replace="~{common/header :: header}"></div>

    <!-- 채팅 컨테이너 -->
    <div class="chat-container">
        <!-- 왼쪽 사이드바 - 대화 목록 -->
        <div class="chat-sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">채팅</h2>
                <p class="sidebar-subtitle">Conversations</p>
            </div>
            
            <div class="conversations-section">
                <!-- 대화 목록이 JavaScript로 동적으로 생성됩니다 -->
            </div>
        </div>

        <!-- 메인 채팅 영역 -->
        <div class="chat-main">
            <div class="chat-header">
                <div>
                    <h3 class="chat-title" id="chat-title">대화를 선택하세요</h3>
                    <p class="chat-members" id="chat-members"></p>
                </div>
                <div class="chat-actions">
                    <button class="chat-action-btn" title="음성 통화">
                        <i class="fas fa-phone"></i>
                    </button>
                    <button class="chat-action-btn" title="영상 통화">
                        <i class="fas fa-video"></i>
                    </button>
                    <button class="chat-action-btn" title="정보">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>

            <!-- 채팅 메시지 영역 -->
            <div class="chat-messages">
                <!-- 메시지들이 JavaScript로 동적으로 생성됩니다 -->
            </div>

            <!-- 메시지 입력 영역 -->
            <div class="chat-input">
                <div class="input-container">
                    <button class="input-btn" onclick="attachFile()" title="첨부">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <button class="input-btn" onclick="shareLink()" title="링크">
                        <i class="fas fa-link"></i>
                    </button>
                    <button class="input-btn" onclick="mentionUser()" title="멘션">
                        <i class="fas fa-at"></i>
                    </button>
                    <button class="input-btn" onclick="insertEmoji()" title="이모티콘">
                        <i class="far fa-smile"></i>
                    </button>
                    <textarea class="message-input" placeholder="메시지를 입력하세요..." rows="1"></textarea>
                    <button class="send-btn" onclick="sendMessage()" title="전송">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- 푸터 -->
    <div th:replace="~{common/footer :: footer}"></div>

    <script src="/crm/js/chat.js"></script>
    <script>
        // 로그인 사용자 id/역할 주입
        window.CURRENT_USER_ID = 1; //사용자  [[${session.userId}]]
        window.SENDER_ROLE = 'SOCIAL'; // 고객 화면이므로 SOCIAL로 고정
    </script>

</body>
</html>
